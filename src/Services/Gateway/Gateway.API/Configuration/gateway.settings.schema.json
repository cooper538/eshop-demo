{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "gateway.settings.schema.json",
  "title": "Gateway Service Configuration",
  "description": "Configuration schema for Gateway Service YAML settings",
  "type": "object",
  "properties": {
    "AllowedHosts": {
      "type": "string",
      "description": "Allowed hosts for the application"
    },
    "Logging": {
      "type": "object",
      "properties": {
        "LogLevel": {
          "type": "object",
          "properties": {
            "Default": {
              "type": "string",
              "enum": ["Trace", "Debug", "Information", "Warning", "Error", "Critical", "None"],
              "description": "Default log level"
            },
            "Microsoft.AspNetCore": {
              "type": "string",
              "enum": ["Trace", "Debug", "Information", "Warning", "Error", "Critical", "None"],
              "description": "Log level for ASP.NET Core"
            },
            "Yarp": {
              "type": "string",
              "enum": ["Trace", "Debug", "Information", "Warning", "Error", "Critical", "None"],
              "description": "Log level for YARP reverse proxy"
            }
          }
        }
      }
    },
    "Gateway": {
      "type": "object",
      "description": "Gateway service specific settings",
      "required": ["Service"],
      "properties": {
        "Service": {
          "type": "object",
          "required": ["Name", "Version"],
          "properties": {
            "Name": {
              "type": "string",
              "maxLength": 50,
              "description": "Service name"
            },
            "Version": {
              "type": "string",
              "description": "Service version"
            }
          }
        },
        "RateLimiting": {
          "type": "object",
          "description": "Rate limiting configuration",
          "properties": {
            "Enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable rate limiting"
            },
            "PermitLimit": {
              "type": "integer",
              "minimum": 1,
              "maximum": 10000,
              "default": 100,
              "description": "Maximum requests allowed in the time window"
            },
            "WindowSeconds": {
              "type": "integer",
              "minimum": 1,
              "maximum": 3600,
              "default": 60,
              "description": "Time window in seconds"
            },
            "QueueLimit": {
              "type": "integer",
              "minimum": 0,
              "maximum": 100,
              "default": 0,
              "description": "Maximum queued requests (0 = no queuing)"
            }
          }
        }
      }
    },
    "ReverseProxy": {
      "type": "object",
      "description": "YARP reverse proxy configuration",
      "properties": {
        "Routes": {
          "type": "object",
          "description": "Route definitions for reverse proxy",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "ClusterId": {
                "type": "string",
                "description": "Target cluster for this route"
              },
              "RateLimiterPolicy": {
                "type": "string",
                "description": "Rate limiter policy name (e.g., 'fixed', 'disable')"
              },
              "Match": {
                "type": "object",
                "properties": {
                  "Path": {
                    "type": "string",
                    "description": "Path pattern to match"
                  }
                }
              }
            }
          }
        },
        "Clusters": {
          "type": "object",
          "description": "Cluster definitions with destinations",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "Destinations": {
                "type": "object",
                "additionalProperties": {
                  "type": "object",
                  "properties": {
                    "Address": {
                      "type": "string",
                      "description": "Destination address (supports Aspire service discovery)"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
